{"version":3,"file":"digitalascetic-ngx-pica.umd.js.map","sources":["ng://@digitalascetic/ngx-pica/lib/ngx-pica-error.interface.ts","ng://@digitalascetic/ngx-pica/lib/ngx-pica-exif.service.ts","ng://@digitalascetic/ngx-pica/lib/ngx-pica.service.ts","ng://@digitalascetic/ngx-pica/lib/ngx-pica-image.service.ts","ng://@digitalascetic/ngx-pica/lib/ngx-pica.module.ts"],"sourcesContent":["export enum NgxPicaErrorType {\n    NO_FILES_RECEIVED = 'NO_FILES_RECEIVED',\n    CANVAS_CONTEXT_IDENTIFIER_NOT_SUPPORTED = 'CANVAS_CONTEXT_IDENTIFIER_NOT_SUPPORTED',\n    NOT_BE_ABLE_TO_COMPRESS_ENOUGH = 'NOT_BE_ABLE_TO_COMPRESS_ENOUGH'\n}\n\nexport interface NgxPicaError {\n    err: NgxPicaErrorType;\n    file?: File;\n}\n","import { Injectable } from '@angular/core';\nimport * as EXIF from 'exif-js';\n\n@Injectable()\nexport class NgxPicaExifService {\n\n    public getExifOrientedImage(image: HTMLImageElement): Promise<HTMLImageElement> {\n        return new Promise<HTMLImageElement>((resolve, reject) => {\n            EXIF.getData((image as any), () => {\n                const allExifMetaData = EXIF.getAllTags(image),\n                    exifOrientation = allExifMetaData.Orientation;\n\n                if (exifOrientation) {\n\n                    if (!/^[1-8]$/.test(exifOrientation)) {\n                        throw new Error('orientation should be [1-8]');\n                    }\n\n                    const canvas: HTMLCanvasElement = document.createElement('canvas'),\n                        ctx = canvas.getContext('2d');\n\n                    let deg = 0,\n                        cx = 0,\n                        cy = 0,\n                        width: number = image.width,\n                        height: number = image.height;\n\n                    if ([5, 6, 7, 8].indexOf(exifOrientation) > -1) {\n                        width = image.height;\n                        height = image.width;\n                    }\n\n                    canvas.width = width;\n                    canvas.height = height;\n\n                    switch (exifOrientation) {\n                        case 3:\n                        case 4:\n                            cx = -image.width;\n                            cy = -image.height;\n                            deg = 180;\n                            break;\n                        case 5:\n                        case 6:\n                            cy = -image.height;\n                            deg = 90;\n                            break;\n                        case 7:\n                        case 8:\n                            cx = -image.width;\n                            deg = 270;\n                            break;\n                        default:\n                            break;\n                    }\n\n                    if ([2, 4, 5, 7].indexOf(exifOrientation) > -1) {\n                        ctx.translate(width, 0);\n                        ctx.scale(-1, 1);\n                    }\n\n                    ctx.rotate(deg / 180 * Math.PI);\n                    ctx.drawImage(image, cx, cy);\n\n                    const img = new Image();\n\n                    img.width = width;\n                    img.height = height;\n\n                    img.onload = () => {\n                        resolve(img);\n                    };\n\n                    img.src = canvas.toDataURL();\n                } else {\n                    resolve(image);\n                }\n            });\n        });\n    }\n\n}\n","import { Injectable } from '@angular/core';\nimport { Subject, Observable, Subscription } from 'rxjs';\nimport { NgxPicaError, NgxPicaErrorType } from './ngx-pica-error.interface';\nimport { NgxPicaResizeOptions } from './ngx-pica-resize-options.interface';\nimport { NgxPicaExifService } from './ngx-pica-exif.service';\nimport Pica from 'pica/dist/pica.js';\n\ndeclare let window: any;\n\n@Injectable()\nexport class NgxPicaService {\n    private picaResizer = new Pica();\n    private MAX_STEPS = 20;\n\n    constructor(private _ngxPicaExifService: NgxPicaExifService) {\n        if (!this.picaResizer || !this.picaResizer.resize) {\n            this.picaResizer = new Pica();\n        }\n    }\n\n    public resizeImages(\n        files: File[],\n        width: number,\n        height: number,\n        options?: NgxPicaResizeOptions\n    ): Observable<File> {\n        const resizedImage: Subject<File> = new Subject();\n        const totalFiles: number = files.length;\n\n        if (totalFiles > 0) {\n            const nextFile: Subject<File> = new Subject();\n            let index = 0;\n\n            const subscription: Subscription = nextFile.subscribe((file: File) => {\n                this.resizeImage(file, width, height, options).subscribe(imageResized => {\n                    index++;\n                    resizedImage.next(imageResized);\n                    if (index < totalFiles) {\n                        nextFile.next(files[index]);\n                    } else {\n                        resizedImage.complete();\n                        subscription.unsubscribe();\n                    }\n                }, (err) => {\n                    const ngxPicaError: NgxPicaError = {\n                        file: file,\n                        err: err\n                    };\n\n                    resizedImage.error(ngxPicaError);\n                });\n            });\n\n            nextFile.next(files[index]);\n        } else {\n            const ngxPicaError: NgxPicaError = {\n                err: NgxPicaErrorType.NO_FILES_RECEIVED\n            };\n            resizedImage.error(ngxPicaError);\n            resizedImage.complete();\n        }\n\n        return resizedImage.asObservable();\n    }\n\n    public resizeImage(\n        file: File,\n        width: number,\n        height: number,\n        options?: NgxPicaResizeOptions\n    ): Observable<File> {\n        const resizedImage: Subject<File> = new Subject();\n        const originCanvas: HTMLCanvasElement = document.createElement('canvas');\n        const ctx = originCanvas.getContext('2d');\n        const img = new Image();\n\n        if (ctx) {\n            img.onload = () => {\n                this._ngxPicaExifService.getExifOrientedImage(img).then(orientedImage => {\n                    window.URL.revokeObjectURL(img.src);\n                    originCanvas.width = orientedImage.width;\n                    originCanvas.height = orientedImage.height;\n\n                    ctx.drawImage(orientedImage, 0, 0);\n\n                    const imageData = ctx.getImageData(0, 0, orientedImage.width, orientedImage.height);\n                    if (options && options.aspectRatio && options.aspectRatio.keepAspectRatio) {\n                        let ratio = 0;\n                        if (options.aspectRatio.forceMinDimensions) {\n                            ratio = Math.max(width / imageData.width, height / imageData.height);\n                        } else {\n                            ratio = Math.min(width / imageData.width, height / imageData.height);\n                        }\n                        width = Math.round(imageData.width * ratio);\n                        height = Math.round(imageData.height * ratio);\n                    }\n\n                    const destinationCanvas: HTMLCanvasElement = document.createElement('canvas');\n                    destinationCanvas.width = width;\n                    destinationCanvas.height = height;\n\n                    this.picaResize(file, originCanvas, destinationCanvas, options)\n                        .then((imgResized: File) => resizedImage.next(imgResized))\n                        .catch((err) => resizedImage.error(err));\n                });\n            };\n            img.src = window.URL.createObjectURL(file);\n        } else {\n            resizedImage.error(NgxPicaErrorType.CANVAS_CONTEXT_IDENTIFIER_NOT_SUPPORTED);\n        }\n\n        return resizedImage.asObservable();\n    }\n\n    public compressImages(files: File[], sizeInMB: number): Observable<File> {\n        const compressedImage: Subject<File> = new Subject();\n        const totalFiles: number = files.length;\n\n        if (totalFiles > 0) {\n            const nextFile: Subject<File> = new Subject();\n            let index = 0;\n\n            const subscription: Subscription = nextFile.subscribe((file: File) => {\n                this.compressImage(file, sizeInMB).subscribe(imageCompressed => {\n                    index++;\n                    compressedImage.next(imageCompressed);\n                    if (index < totalFiles) {\n                        nextFile.next(files[index]);\n                    } else {\n                        compressedImage.complete();\n                        subscription.unsubscribe();\n                    }\n                }, (err) => {\n                    const ngxPicaError: NgxPicaError = {\n                        file: file,\n                        err: err\n                    };\n                    compressedImage.error(ngxPicaError);\n                });\n            });\n\n            nextFile.next(files[index]);\n        } else {\n            const ngxPicaError: NgxPicaError = {\n                err: NgxPicaErrorType.NO_FILES_RECEIVED\n            };\n            compressedImage.error(ngxPicaError);\n            compressedImage.complete();\n        }\n\n        return compressedImage.asObservable();\n    }\n\n    public compressImage(file: File, sizeInMB: number): Observable<File> {\n        const compressedImage: Subject<File> = new Subject();\n\n        if (this.bytesToMB(file.size) <= sizeInMB) {\n            setTimeout(() => compressedImage.next(file));\n        } else {\n            const originCanvas: HTMLCanvasElement = document.createElement('canvas');\n            const ctx = originCanvas.getContext('2d');\n            const img = new Image();\n\n            if (ctx) {\n                img.onload = () => {\n                    this._ngxPicaExifService.getExifOrientedImage(img).then(orientedImage => {\n                        window.URL.revokeObjectURL(img.src);\n                        originCanvas.width = orientedImage.width;\n                        originCanvas.height = orientedImage.height;\n\n                        ctx.drawImage(orientedImage, 0, 0);\n\n                        this.getCompressedImage(originCanvas, file.type, 1, sizeInMB, 0)\n                            .catch((err) => compressedImage.error(err))\n                            .then((blob: Blob) => {\n                                const imgCompressed: File = this.blobToFile(blob, file.name, file.type, new Date().getTime());\n                                compressedImage.next(imgCompressed);\n                            });\n                    });\n                };\n\n                img.src = window.URL.createObjectURL(file);\n            } else {\n                compressedImage.error(NgxPicaErrorType.CANVAS_CONTEXT_IDENTIFIER_NOT_SUPPORTED);\n            }\n        }\n\n        return compressedImage.asObservable();\n    }\n\n    private getCompressedImage(\n        canvas: HTMLCanvasElement,\n        type: string,\n        quality: number,\n        sizeInMB: number,\n        step: number\n    ): Promise<Blob> {\n        return new Promise<Blob>((resolve, reject) => {\n            this.picaResizer.toBlob(canvas, type, quality)\n                .catch((err) => reject(err))\n                .then((blob: Blob) => {\n                    this.checkCompressedImageSize(canvas, blob, quality, sizeInMB, step)\n                        .then((compressedBlob: Blob) => resolve(compressedBlob))\n                        .catch((err) => reject(err));\n                });\n        });\n    }\n\n    private checkCompressedImageSize(\n        canvas: HTMLCanvasElement,\n        blob: Blob,\n        quality: number,\n        sizeInMB: number,\n        step: number\n    ): Promise<Blob> {\n        return new Promise<Blob>((resolve, reject) => {\n            if (step > this.MAX_STEPS) {\n                reject(NgxPicaErrorType.NOT_BE_ABLE_TO_COMPRESS_ENOUGH);\n            } else if (this.bytesToMB(blob.size) < sizeInMB) {\n                resolve(blob);\n            } else {\n                const newQuality: number = quality - (quality * 0.1);\n                const newStep: number = step + 1;\n                // recursively compression\n                resolve(this.getCompressedImage(canvas, blob.type, newQuality, sizeInMB, newStep));\n            }\n        });\n    }\n\n    private picaResize(\n        file: File,\n        from: HTMLCanvasElement,\n        to: HTMLCanvasElement,\n        options: any\n    ): Promise<File> {\n        return new Promise<File>((resolve, reject) => {\n            this.picaResizer.resize(from, to, options)\n                .catch((err) => reject(err))\n                .then((resizedCanvas: HTMLCanvasElement) => this.picaResizer.toBlob(resizedCanvas, file.type))\n                .then((blob: Blob) => {\n                    const fileResized: File = this.blobToFile(blob, file.name, file.type, new Date().getTime());\n                    resolve(fileResized);\n                });\n        });\n    }\n\n    private blobToFile(blob: Blob, name: string, type: string, lastModified: number): File {\n        return new File([blob], name, { type: type, lastModified: lastModified });\n    }\n\n    private bytesToMB(bytes: number) {\n        return bytes / 1048576;\n    }\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class NgxPicaImageService {\n\n    private imageExtensions: string[] = [\n        'ase',\n        'art',\n        'bmp',\n        'blp',\n        'cd5',\n        'cit',\n        'cpt',\n        'cr2',\n        'cut',\n        'dds',\n        'dib',\n        'djvu',\n        'egt',\n        'exif',\n        'gif',\n        'gpl',\n        'grf',\n        'icns',\n        'ico',\n        'iff',\n        'jng',\n        'jpeg',\n        'jpg',\n        'jfif',\n        'jp2',\n        'jps',\n        'lbm',\n        'max',\n        'miff',\n        'mng',\n        'msp',\n        'nitf',\n        'ota',\n        'pbm',\n        'pc1',\n        'pc2',\n        'pc3',\n        'pcf',\n        'pcx',\n        'pdn',\n        'pgm',\n        'PI1',\n        'PI2',\n        'PI3',\n        'pict',\n        'pct',\n        'pnm',\n        'pns',\n        'ppm',\n        'psb',\n        'psd',\n        'pdd',\n        'psp',\n        'px',\n        'pxm',\n        'pxr',\n        'qfx',\n        'raw',\n        'rle',\n        'sct',\n        'sgi',\n        'rgb',\n        'int',\n        'bw',\n        'tga',\n        'tiff',\n        'tif',\n        'vtf',\n        'xbm',\n        'xcf',\n        'xpm',\n        '3dv',\n        'amf',\n        'ai',\n        'awg',\n        'cgm',\n        'cdr',\n        'cmx',\n        'dxf',\n        'e2d',\n        'egt',\n        'eps',\n        'fs',\n        'gbr',\n        'odg',\n        'svg',\n        'stl',\n        'vrml',\n        'x3d',\n        'sxd',\n        'v2d',\n        'vnd',\n        'wmf',\n        'emf',\n        'art',\n        'xar',\n        'png',\n        'webp',\n        'jxr',\n        'hdp',\n        'wdp',\n        'cur',\n        'ecw',\n        'iff',\n        'lbm',\n        'liff',\n        'nrrd',\n        'pam',\n        'pcx',\n        'pgf',\n        'sgi',\n        'rgb',\n        'rgba',\n        'bw',\n        'int',\n        'inta',\n        'sid',\n        'ras',\n        'sun',\n        'tga'\n    ];\n\n    public isImage(file: File): boolean {\n        const fileExtension: string = file.name.toLowerCase().substr(file.name.lastIndexOf('.') + 1);\n        return (this.imageExtensions.indexOf(fileExtension) !== -1);\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { NgxPicaService } from './ngx-pica.service';\nimport { NgxPicaExifService } from './ngx-pica-exif.service';\nimport { NgxPicaImageService } from './ngx-pica-image.service';\n\n@NgModule({\n    providers: [\n        { provide: NgxPicaService, useClass: NgxPicaService },\n        { provide: NgxPicaExifService, useClass: NgxPicaExifService },\n        { provide: NgxPicaImageService, useClass: NgxPicaImageService },\n    ]\n})\nexport class NgxPicaModule { }\n"],"names":["EXIF.getData","EXIF.getAllTags","Injectable","Subject","NgModule"],"mappings":"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BACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,IAAI;gBACJ,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,IAAI;gBACJ,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,IAAI;gBACJ,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,IAAI;gBACJ,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,IAAI;gBACJ,KAAK;gBACL,MAAM;gBACN,KAAK;gBACL,KAAK;gBACL,KAAK;gBACL,KAAK;aACR,CAAC;SAML;;;;;QAJU,qCAAO;;;;YAAd,UAAe,IAAU;;oBACf,aAAa,GAAW,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBAC5F,QAAQ,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,EAAE;aAC/D;;oBAjIJA,eAAU;;QAkIX,0BAAC;KAlID;;;;;;ACFA;QAKA;SAO8B;;oBAP7BE,aAAQ,SAAC;wBACN,SAAS,EAAE;4BACP,EAAE,OAAO,EAAE,cAAc,EAAE,QAAQ,EAAE,cAAc,EAAE;4BACrD,EAAE,OAAO,EAAE,kBAAkB,EAAE,QAAQ,EAAE,kBAAkB,EAAE;4BAC7D,EAAE,OAAO,EAAE,mBAAmB,EAAE,QAAQ,EAAE,mBAAmB,EAAE;yBAClE;qBACJ;;QAC4B,oBAAC;KAP9B;;;;;;;;;;;;;;;;;;;;;;;;;"}
